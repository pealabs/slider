<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport"content="width=device-width, height=device-height, initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0, user-scalable=no" />
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<style>

</style>
<script>
$(document).ready(function() 
{
	var s1 = new slider({
		slider:'slider'
		,contents:'contents'
		,content:'content'
		,right:'right'
		,left:'left'
		,navi:'navi'
		,width:300
		//,width:$('.slider').width()
		,height:200
		//,height:$('.slider').height()
		,switchingSpeed:500
		,rotationalSpeed:2000
		,autoRepeat:false
		,touch:true
		,reverse:true
	}).run();
	
})

function slider(opt)
{
	var sn = opt.slider; //슬라이더 명
	var cns = opt.contents;//컨텐츠 ul 명
	var cn = opt.content;//컨텐츠 li 명
	var sw = opt.width; //슬라이더 뷰어 너비
	var sh = opt.height; //슬라이더 뷰어 폭
	var cc = $('.'+cn).length; //컨텐츠  갯수
	var ctw = sw*cc; //컨텐츠 총 길이
	var sp = opt.switchingSpeed; //슬라이드 속도
	var rs = opt.rotationalSpeed; //반복 속도
	var ar = opt.autoRepeat;//자동 반복
	var rmv = opt.right; //오른쪽 이동 버튼 명
	var lmv = opt.left;//왼쪽 이동 버튼 명
	var tc = opt.touch;//터치 사용 여부
	var rv = opt.reverse;//되감기 여부
	this.run = init
	
	function init()
	{
		$('.'+sn+' ul').css('list-style','none');
		$('.'+sn+' ul').css('padding','0px');
		$('.'+sn+' ul').css('margin','0px');
		$('.'+sn+' ul>li').css('list-style','none');
		$('.'+sn+' ul>li').css('padding','0px');
		$('.'+sn+' ul>li').css('float','left');
		
		$('.'+sn).css('overflow','hidden');
		$('.'+sn).css('margin','0px');
		$('.'+sn).css('padding','0px');
		$('.'+sn).css('width',sw+'px');
		$('.'+sn).css('heigth',sh+'px');
		$('.'+sn).css('z-index','9');

		$('.'+cns).css('width',ctw+'px');
		
		$('.'+cn).css('width',sw+'px');
		$('.'+cn).css('height',sh+'px');
		
		$('.'+rmv).click(function(){
			movement(0);
		})
		$('.'+lmv).click(function(){
			movement(1);
		})
		if(rv)
		{
			var re = Number($('.'+cns).attr('pos'))+sw;
			$('.'+sn).scrollLeft(re);
			$('.'+cns).attr('pos',$('.'+sn).scrollLeft());
			$('.'+cn).first().before($('.'+cn).last());
		}
		if(ar)
		{
			setInterval(function() {
				movement(0);
			}, opt.rotationalSpeed );
		}
		
		if(tc)
		{
			$('.'+sn).bind('touchstart',function(event){touchstart(event);});
			$('.'+sn).bind('touchmove',function(event){touchmove(event);});
			$('.'+sn).bind('touchend',function(event){touchend(event);});
			$('.'+sn).on('mousedown',function(event){touchstart(event);});
			$('.'+sn).on('mousemove',function(event){touchmove(event);});
			$('.'+sn).on('mouseup',function(event){touchend(event);});
		}
		$('.'+sn).mouseup(function(){
			isMouseDown = false;
		})
	}	
	var stx = null;
	var sty = null;
	var mtx = null;
	var mty = null;
	var etx = null;
	var ety = null;
	var spx = null;
	var spy = null;
	var isMouseDown = false;
	function touchstart(event)
	{
		isMouseDown = true;
		event.preventDefault();
		var e = event.originalEvent;
		stx = e.pageX || e.targetTouches[0].pageX;
		sty = e.pageY || e.targetTouches[0].pageY;
		//console.info(stx+':'+sty);
		$('.x').html(stx);
		$('.y').html(sty);
	}
	function touchmove(event)
	{
		if(isMouseDown)
		{
			event.preventDefault();
			var e = event.originalEvent;
			mtx = e.pageX || e.targetTouches[0].pageX;
			mty = e.pageY || e.targetTouches[0].pageY;
			//console.info(mtx+':'+mty);
		
			$('.x').html(mtx);
			$('.y').html(mty);
			
			$('.'+sn).scrollLeft(Number($('.'+cns).attr('pos'))+(stx-mtx))
		}
	}
	function touchend(event)
	{
		event.preventDefault();
		var e = event.originalEvent;
		etx = e.pageX || e.changedTouches[0].pageX;
		ety = e.pageY || e.changedTouches[0].pageY;
		//console.info(etx+':'+ety);
		$('.x').html(etx);
		$('.y').html(ety);
		
		//console.info(stx-etx);
		
		
		var center = sw/2;
		if((stx-etx)<0)
		{
			if(etx>center)
			{
				//console.info('좌에서 우로 넘어감');
				movement(1);
			}
			if(etx<center)
			{
				//console.info('좌에서 우로 안넘어감');
				$('.'+sn).animate({
					scrollLeft:Number($('.'+cns).attr('pos'))
				},sp,function(){});
			}
		}
		if((stx-etx)>0)
		{
			if(etx<center)
			{
				movement(0);
				//console.info('우에서 좌로 넘어감');
			}
			if(etx>center)
			{
				//console.info('우에서 좌로 안넘어감');
				$('.'+sn).animate({
					scrollLeft:Number($('.'+cns).attr('pos'))
				},sp,function(){});
			}
		}
	}
	function movement(cmd)
	{
		//console.info($('.'+cns).attr('pos'));
		var mv = 0;
			
		if(cmd==0)
		{
			mv = Number($('.'+cns).attr('pos'))+sw;	
		}
		if(cmd==1)
		{
			mv = Number($('.'+cns).attr('pos'))-sw;
		}
		
		//이동
		$('.'+sn).animate({
			scrollLeft:mv
		}, sp, function() {
			//현재 위치
			$('.'+cns).attr('pos',$('.'+sn).scrollLeft());
			if(rv)
			{
				if(mv==(ctw-sw) && cmd==0){
					$('.'+cn).last().after($('.'+cn).first());
					var re = Number($('.'+cns).attr('pos'))-sw;
					$('.'+sn).scrollLeft(re);
					$('.'+cns).attr('pos',$('.'+sn).scrollLeft());
				}
				if(mv==0 && cmd==1){
					$('.'+cn).first().before($('.'+cn).last());
					var re = Number($('.'+cns).attr('pos'))+sw;
					$('.'+sn).scrollLeft(re);
					$('.'+cns).attr('pos',$('.'+sn).scrollLeft());
					
				}
			}
		});
		
	}
}
</script>
</head>
<body>
<div class="slider">
	<ul class="contents" pos="0">
		<li class="content">
			1
		</li>
		<li class="content">
			2
		</li>
		<li class="content">
			3
		</li>
		<li class="content">
			4
		</li>
	</ul>
</div>
<div class="navi"></div>
<div class="left">좌</div>
<div class="right">우</div>
<div class="current">0</div>
<div class="x">0</div>
<div class="y">0</div>

</body>
</html>
